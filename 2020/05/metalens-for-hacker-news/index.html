<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Victor Bitca">
<meta name="description" content="Download it on the app store  Motivation I would often scroll HN, see something interesting but not open the link, by the time I got home from the office (remember offices?) it was from the top items. At the end of the day, I just wanted a way to go back in time at a specific hour or get a curated list of news items
Metalens daily HN digest email  This is how it all started, as a newsletter, with only one subscriber, me." />
<meta name="keywords" content=", iOS, Swift, Hacker News" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://3am.engineering/2020/05/metalens-for-hacker-news/" />


    <title>
        
            Metalens for Hacker News :: 3AM Engineering  â€” Hello there
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.2f0d18b84270567c723bff340b09ab08db3a7634237cd9667d052eb6b14669b8.css">




<meta itemprop="name" content="Metalens for Hacker News">
<meta itemprop="description" content="Download it on the app store  Motivation I would often scroll HN, see something interesting but not open the link, by the time I got home from the office (remember offices?) it was from the top items. At the end of the day, I just wanted a way to go back in time at a specific hour or get a curated list of news items
Metalens daily HN digest email  This is how it all started, as a newsletter, with only one subscriber, me.">


<meta itemprop="datePublished" content="2020-05-19T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2020-05-19T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="901">



<meta itemprop="keywords" content="iOS, Swift, Hacker News," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Metalens for Hacker News"/>
<meta name="twitter:description" content="Download it on the app store  Motivation I would often scroll HN, see something interesting but not open the link, by the time I got home from the office (remember offices?) it was from the top items. At the end of the day, I just wanted a way to go back in time at a specific hour or get a curated list of news items
Metalens daily HN digest email  This is how it all started, as a newsletter, with only one subscriber, me."/>





    <meta property="article:published_time" content="2020-05-19 00:00:00 &#43;0000 UTC" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__text">home</span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://3am.engineering/about/">about</a></li><li><a href="https://3am.engineering/posts/">posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://3am.engineering/2020/05/metalens-for-hacker-news/">Metalens for Hacker News</a></h2>

            

            <div class="post-content">
                

<h4 id="download-it-on-the-app-store-https-apps-apple-com-us-app-metalens-id1506654571-ls-1"><a href="https://apps.apple.com/us/app/metalens/id1506654571?ls=1">Download it on the app store</a></h4>


    <figure class="left" >
        <img src="/images/metalens_logo.jpg"   />

        
    </figure>



<h3 id="motivation">Motivation</h3>

<p>I would often scroll HN, see something interesting but not open the link, by the time I got home from the office (remember offices?) it was from the top items. At the end of the day, I just wanted a way to go back in time at a specific hour or get a curated list of news items</p>


    <figure class="left" >
        <img src="/images/hn_digest_1.jpg"   />

        
            <figcaption class="center" >Metalens daily HN digest email</figcaption>
        
    </figure>



<p>This is how it all started, as a newsletter, with only one subscriber, me.
For categorization I used natural language processing from GCP, news items would get categorized either by the site&rsquo;s content or by HN comments, depends on what source gave a better confidence result.
If the categories seem familiar it&rsquo;s probably because Reddit probably uses the same API for its categorization.</p>

<p>Either way, it would only hit the mark for half of the items, the rest of the items needed some manual help, the language processing, and categorization part need a lot more work,
I think that&rsquo;s one reason why AI startups use people and sell it as an AI service anticipating that some their models will be able to finally replace the humans at that specific task, Intelligence as a Service?</p>

<h1 id="the-ios-app">The iOS app</h1>


    <figure class="left" >
        <img src="/images/metalens_app.jpg"   />

        
    </figure>



<p>A few months ago I decided to put my best efforts into an iOS client for HN, yes I know there are some good apps out there but they offer the same or fewer features than the HN website.</p>

<p>The almost &ldquo;real-time&rdquo; analytics I thought looks fun and even offers an insight into how an item/topic is doing overtime in comments and score activity.</p>

<p>I often use the granular time travel to back and read some pretty cool items I missed, it works fine for me, I&rsquo;m more of a lurker, the comments I wanted to write are often already written by somebody else or the subject is way out of my domain of expertise.</p>

<h3 id="happy-accidents">Happy accidents</h3>

<p>About the flame graph, on top it tracks score activity and on the bottom the conversation activity.</p>


    <figure class="left" >
        <img src="/images/metalens_graphs.jpg"   />

        
            <figcaption class="center" >Flamy graphs!</figcaption>
        
    </figure>



<p>But its appearance is a &ldquo;bug&rdquo;, I mean there should only be a max of 5 red dots, 3 yellow, 2 blue, per column in score activity.
It&rsquo;s the result of a series of little happy accidents made in a late-night engineering session. I looked at it the other day, I have no idea what I wrote, I&rsquo;ll leave that part untouched, wrote some tests to make sure the output values were withing range, I&rsquo;ll leave the magic undisturbed, plus it makes the flame graph look more &ldquo;flamy&rdquo;!</p>

<h3 id="swiftui">SwiftUI</h3>

<p>Initially tried Swift UI, development was going so fast, &ldquo;I will probably never go back to UIKit&rdquo; I was thinking while clicking away, the prototyping phase went smooth.
But SwiftUI it&rsquo;s not ready for production yet, it makes some things trivial and some trivial things a pain in the ass.</p>

<ul>
<li>Want to implement a pull to refresh feature, nope.</li>
<li>Want to find out how far has the user scrolled the list? nope.</li>
<li>The list goes on.</li>
</ul>

<p>There are workarounds, but it felt like I was fighting SwiftUI.
Also, the app at that stage had some bizarre bugs when items in a list would not have the correct height until you scrolled a pixel or two.
Then the scrolling performance was not good, using UIKit and CoreAnimation reduced CPU time in half when scrolling the same items.
I had to rewrite it all in good old UIKit.</p>

<h3 id="app-store-review-process">App store review process</h3>

<p>I got the same rejection reason as <a href="https://medium.com/swlh/my-app-is-dead-in-the-water-93a97a137eff">Matt Stanford with his Hacker News Zero app</a>.
The only way I could get it approved was by opening links in Safari app, while every other app seems to get away just fine by opening them in <code>SFSafariViewController</code>.
I included a toggle switch in settings when enabled opens links in <code>SFSafariViewController</code> and this seems to satisfy the reviewer,</p>

<p>The more you think about it the less sense it makes. Why Apple even added <code>SFSafariViewController</code> and recommends it as the primary way to open external links, should it only be used for ToS and Privacy Policies?</p>


    <figure class="left" >
        <img src="/images/legal_issues.jpg"   />

        
            <figcaption class="center" >Copyright infringement?</figcaption>
        
    </figure>



<p>Then there was the inappropriate use of auto-renewing subscriptions, the reviewers were very insistent that I should use non-renewing subscription even after adding additional features to the Metalens Premium package.
Ok, Apple, be it your way.</p>


    <figure class="left" >
        <img src="/images/subscriptions_issues.jpg"   />

        
    </figure>



<p>But after 6 reviews and 5 iterations, Metalens finally got approved. If you plan to install and use it definitely toggle on the &ldquo;Use internal Safari browser&rdquo; switch.</p>

<h3 id="upcoming-features-and-improvements">Upcoming features and improvements</h3>

<p>The app is still not there yet in terms of features, there is a lot more work to be done, If you would like to support the development and prevent another forgotten HN client app zombie on the app store you should subscribe to Metalens Premium.</p>

<ul>
<li>Add search, seems like a trivial thing to add with <a href="https://hn.algolia.com/api">HN Search API</a></li>
<li>Add trends with <a href="https://showcase.metamate.io/hackernews-trends">Metamate</a></li>
<li>I would really like to improve the current &ldquo;Curated Feed&rdquo; section, rework categories and maybe use trends to its advantage, a lot to explore here.</li>
<li>Get notified when someone replies to your comments or submission.</li>
<li>Add one-time payment as an alternative to subscriptions.</li>
</ul>

<h1 id="the-backend">The backend</h1>

<p>Nothing special, Go + SQLite running in a VM on CGP with Cloudflare + CF Workers so I could take advantage of their network and cache in case the app gets a surge of requests, how optimistic of me.</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
  				<p>
  					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://3am.engineering/tags/ios-swift-hacker-news">iOS, Swift, Hacker News</a></span>
  				</p>
  			</div>

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
                <span><a href="https://3am.engineering/">3AM Engineering</a></span>
            
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.2d5469329143160ae2456a69c3c76dc2d0a3b212b46afe291a51bd68650ed6f8697e001dab54f1c272c77ce08092a8c55e5bb4314e0ee334aab4b927ec896638.js" integrity="sha512-LVRpMpFDFgriRWppw8dtwtCjshK0av4pGlG9aGUO1vhpfgAdq1TxwnLHfOCAkqjFXlu0MU4O4zSqtLkn7IlmOA=="></script>



    </body>
</html>
