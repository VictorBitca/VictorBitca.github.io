<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Victor Bitca">
<meta name="description" content="TL;DR I wanted a controller specifically made for racing sim games, with force feedback like on the big expensive sim racing wheels, so I made one.
 The Inspiration The new PS5 controller with its haptics and adaptive triggers marks the dawn of a new era [citation needed]. At least that&amp;rsquo;s what the reviewers say, I&amp;rsquo;ll give them the benefit of the doubt since I can&amp;rsquo;t get my hands on one." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://3am.engineering/works/controller-feedback/" />


    <title>
        
            Custom force-feedback controller and speculations on next-gen :: 3am engineering 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.5bfb908ea0e9e0fa4f7e8016a36896c5e4f71b49cc913f137c1c0f6b4dda0525.css">




<meta itemprop="name" content="Custom force-feedback controller and speculations on next-gen">
<meta itemprop="description" content="TL;DR I wanted a controller specifically made for racing sim games, with force feedback like on the big expensive sim racing wheels, so I made one.
 The Inspiration The new PS5 controller with its haptics and adaptive triggers marks the dawn of a new era [citation needed]. At least that&rsquo;s what the reviewers say, I&rsquo;ll give them the benefit of the doubt since I can&rsquo;t get my hands on one."><meta itemprop="datePublished" content="2021-04-13T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-04-13T00:00:00+00:00" />
<meta itemprop="wordCount" content="906">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Custom force-feedback controller and speculations on next-gen"/>
<meta name="twitter:description" content="TL;DR I wanted a controller specifically made for racing sim games, with force feedback like on the big expensive sim racing wheels, so I made one.
 The Inspiration The new PS5 controller with its haptics and adaptive triggers marks the dawn of a new era [citation needed]. At least that&rsquo;s what the reviewers say, I&rsquo;ll give them the benefit of the doubt since I can&rsquo;t get my hands on one."/>





    <meta property="article:published_time" content="2021-04-13 00:00:00 &#43;0000 UTC" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__text">3am engineering</span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://3am.engineering/about/">About</a></li><li><a href="https://3am.engineering/works/">Works</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://3am.engineering/works/controller-feedback/">Custom force-feedback controller and speculations on next-gen</a></h2>

            

            <div class="post-content">
                <h2 id="tldr">TL;DR</h2>
<p>I wanted a controller specifically made for racing sim games, with force feedback like on the big expensive sim racing wheels, so I made one.</p>
<figure><img src="/images/all_controllers.jpg"/>
</figure>

<h2 id="the-inspiration">The Inspiration</h2>
<p>The new PS5 controller with its haptics and adaptive triggers marks the dawn of a new era [citation needed].
At least <a href="https://youtu.be/tIqlu4sm5OQ">that&rsquo;s what the reviewers say</a>, I&rsquo;ll give them the benefit of the doubt since I can&rsquo;t get my hands on one.</p>
<p><figure><img src="/images/ps5trigger.gif"/>
</figure>

<a href="https://en.wikipedia.org/wiki/Haptic_technology#Force_feedback">What even is FFB?</a> and why it makes things better?
Maybe the industry will move towards an &ldquo;FFB all the things&rdquo; approach, maybe not, let&rsquo;s test it out and see its pros and cons.</p>
<h2 id="history-lesson">History lesson</h2>
<p><a href="https://en.wikipedia.org/wiki/Joystick#Electronic_joysticks">A joystick</a>, i.e., the thing that moves in at least two dimensions X and Y is nothing new, also nothing new is FFB for joysticks.
<a href="https://en.wikipedia.org/wiki/Microsoft_SideWinder">Microsoft made some decent devices in the late 90</a> specifically for flight simulators.</p>
<p><a href="https://en.wikipedia.org/wiki/Racing_wheel">FFB sim racing wheels</a> impossible to get your hands on during the pandemic, then there&rsquo;s the crazy <a href="https://youtu.be/X1BKkZs3DvA">expensive industrial FFB joysticks</a>.</p>
<p>Plenty of examples to draw inspiraton from.</p>
<h3 id="im-just-trying-to-play-racing-simulators-with-one-finger-without-compromising-on-ffb">I&rsquo;m just trying to play racing simulators with one finger without compromising on FFB.</h3>
<p>Why FFB is important? if implemented properly the FFB delivers a lot of data about the forces that the car is experiencing, things like:</p>
<ol>
<li>Oversteer while cornering: is the car on the verge of losing control of the back end of the car and spin around.</li>
<li>Understeer while cornering: the front end of the car is sliding and there&rsquo;s nothing you can do to change that.</li>
<li>Weight transfer side to side: this one it&rsquo;s a bit harder to explain in one sentence&hellip;</li>
<li>Road texture/vibrations: Self-explanatory, not always realistic but helps with immersion.</li>
</ol>
<p>In short, FFB gives you the feedback you would need to drive more on the edge doing cool drifts if that your thing.
Yes, It can&rsquo;t replace the experience of driving a car but you weren&rsquo;t expecting that, did you? We&rsquo;re just building a joystick here.</p>
<h2 id="first-iteration">First iteration</h2>
<p>Driving simulators are a good starting point, there&rsquo;s only one axis respectively one motor and plenty of games should support FFB wheels.</p>
<p>Started with tearing down an old cheap controller, got the spring out that centers the joystick locked the vertical axis. Used a simple brushed motor, just soldered the brass gear onto the shaft of the joystick axis.</p>
<figure><img src="/images/first_controller.jpg"/>
</figure>

<p>This worked surprisingly well, for a motor welded to a joystick, it was an instant success if we ignore the extreme inefficiency/power consumption/generated heat of that motor working in a stalled state and the overall low torque.</p>
<h2 id="second-iteration">Second iteration</h2>
<p>The second iteration was based on a servo, it should address the lack of torque and inefficiency of the first design.
Also, the original servo motor was replaced with a <a href="https://www.motioncontroltips.com/what-are-coreless-dc-motors/">coreless motor</a> to make the back driving as smooth as possible.</p>
<figure><img src="/images/second_controller_motor.jpg"/>
</figure>

<p>Torque wasn&rsquo;t a problem anymore, but the road details and other high-frequency forces were lost in the spaces between gear teeth, only low-frequency details would come through, no good!</p>
<h2 id="third-iteration">Third iteration</h2>
<p>The third prototype was based on a <a href="https://en.wikipedia.org/wiki/Brushless_DC_electric_motor">BLDC motor</a>, I decided to use directly the motor body as the &ldquo;joystick&rdquo; itself.</p>
<figure><img src="/images/third_controller.jpg"
         alt="Just a few extra parts to illustrate what&amp;rsquo;s inside"/><figcaption>
            <p>Just a few extra parts to illustrate what&rsquo;s inside</p>
        </figcaption>
</figure>

<p>Parts list:</p>
<ul>
<li><a href="https://cheapdrone.co.uk/fpv-drones/fpv-motors/flashhobby-gbm2606-90t-120kv-14p12n-4mm-hollow-shaft-40g-gimbal-motor-drone-parts">BLDC motor: Flashhobby GBM2606-90T 120KV 14P12N</a> a high torque, high impedance, low RPM motor.</li>
<li><a href="https://www.amazon.com/Axis-Brushless-Gimbal-Controller-Gy6050/dp/B01MT8HIZP">BLDC controller: Bgc 3.1 2 Axis Brushless Gimbal Controller</a> basically an Arduino Nano + a bunch of MOSFETs</li>
<li>Arduino Leonardo: as the thing that pretends it&rsquo;s a sim racing wheel.</li>
<li>Magnetic encoder: AS5600 - to read the motor angle.</li>
<li>Diametrically polarized magnet: it&rsquo;s a magnet.</li>
</ul>
<p>First impressions: great direct feedback, lots of torque, all the torque in the world, had to dial it very low to be usable.</p>
<p>Second impressions: there&rsquo;s always a bit of resistance to rotation, I can feel stator armature and magnetic poles aligning when the controller applies little or no torque.</p>
<p>Still power-hungry, USB should provide more than 0.5A but I did not have the time to figure out why it wasn&rsquo;t the case for me, used an external power supply.</p>
<h4 id="the-software">The software</h4>
<p>The software running on main Arduino Leonardo is built on top of the <a href="https://github.com/hoantv/VNWheel">VNWheel</a> project, required some heavy refactoring and cleanup.</p>
<p>The gimbal controller software is using mainly the <a href="https://docs.simplefoc.com/">FOC library</a> it handles the motor + encoder, can do both torque and position control, very useful library.</p>
<p>Communication between boards is done using the I2C bus.</p>
<p><a href="https://github.com/VictorBitca/force-feedback-controller">The project repo</a></p>
<h2 id="epilogue">Epilogue</h2>
<p>An FFB joystick provides another dimension to the gaming experience, but it comes at a cost.</p>
<p>If similar tech is to be implemented in the next-gen controllers there&rsquo;s some work on the way there:</p>
<ul>
<li>Console manufacturers need to design the hardware and the SDK, pretty feasible, considering its not new tech.</li>
<li>Game engine developers have to implement the SDK and expose a higher-level API to the engine users, also doable.</li>
<li>Game developers need to think about FFB as they think about sound or visual effects.
Canned effects like resistance or impacts can be used for regular games, additional work required for dedicated flight or driving sims, or just fall back to good old regular spring simulation.</li>
<li>Battery tech/capacity improvements, this is a big one, any additional motor is a drain on the battery, I imagine battery life to be in the range of a few hours with current battery tech.</li>
</ul>
<p>What was the point of this prototype? As I said I just wanted to play racing games on my couch instead of using the wheel, first-world problems.</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
  			</div>

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2021</span>
            
                <span><a href="https://3am.engineering/">3am engineering</a></span>
            
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.08ccaf9cef8b4e0ebd0b0158e66a7bfc0ddbb2194cdb0099e8814ddb89cc7628b27b1158846564e6e03d9ffc5f4d1bc7dfc274d359f9408d1c63d73a3f7332e9.js" integrity="sha512-CMyvnO&#43;LTg69CwFY5mp7/A3bshlM2wCZ6IFN24nMdiiyexFYhGVk5uA9n/xfTRvH38J001n5QI0cY9c6P3My6Q=="></script>



    </body>
</html>
